<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gaussian Process · CalibrateEmulateSample.jl</title><meta name="title" content="Gaussian Process · CalibrateEmulateSample.jl"/><meta property="og:title" content="Gaussian Process · CalibrateEmulateSample.jl"/><meta property="twitter:title" content="Gaussian Process · CalibrateEmulateSample.jl"/><meta name="description" content="Documentation for CalibrateEmulateSample.jl."/><meta property="og:description" content="Documentation for CalibrateEmulateSample.jl."/><meta property="twitter:description" content="Documentation for CalibrateEmulateSample.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="CalibrateEmulateSample.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CalibrateEmulateSample.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation_instructions/">Installation instructions</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/sinusoid_example/">Simple example walkthrough</a></li><li><a class="tocitem" href="../examples/lorenz_example/">Lorenz example</a></li><li><a class="tocitem" href="../examples/edmf_example/">Turbulence example</a></li><li><a class="tocitem" href="../examples/Cloudy_example/">Cloudy example</a></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Emulator testing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/emulators/regression_2d_2d/">Regression of <span>$\mathbb{R}^2 \to \mathbb{R}^2$</span> smooth function</a></li><li><a class="tocitem" href="../examples/emulators/lorenz_integrator_3d_3d/">Integrating Lorenz 63 with an emulated integrator</a></li><li><a class="tocitem" href="../examples/emulators/ishigami_3d_1d/">Global Sensitiviy Analysis for an emulated Ishigami function</a></li></ul></li></ul></li><li><a class="tocitem" href="../calibrate/">Calibrate</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Emulate</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../emulate/">Emulator</a></li><li class="is-active"><a class="tocitem" href>Gaussian Process</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#User-Interface"><span>User Interface</span></a></li><li class="toplevel"><a class="tocitem" href="#Prediction-Type"><span>Prediction Type</span></a></li><li class="toplevel"><a class="tocitem" href="#Kernels"><span>Kernels</span></a></li><li><a class="tocitem" href="#GPJL"><span>GPJL</span></a></li><li><a class="tocitem" href="#SKLJL"><span>SKLJL</span></a></li><li class="toplevel"><a class="tocitem" href="#Learning-additional-white-noise"><span>Learning additional white noise</span></a></li></ul></li><li><a class="tocitem" href="../random_feature_emulator/">Random Features</a></li></ul></li><li><a class="tocitem" href="../sample/">Sample</a></li><li><a class="tocitem" href="../glossary/">Glossary</a></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-9-1" type="checkbox"/><label class="tocitem" for="menuitem-9-1"><span class="docs-label">CalibrateEmulateSample</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-9-1-1" type="checkbox"/><label class="tocitem" for="menuitem-9-1-1"><span class="docs-label">Emulators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../API/Emulators/">General Interface</a></li><li><a class="tocitem" href="../API/GaussianProcess/">Gaussian Process</a></li><li><a class="tocitem" href="../API/RandomFeatures/">Random Features</a></li></ul></li><li><a class="tocitem" href="../API/MarkovChainMonteCarlo/">MarkovChainMonteCarlo</a></li><li><a class="tocitem" href="../API/Utilities/">Utilities</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Emulate</a></li><li class="is-active"><a href>Gaussian Process</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gaussian Process</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/CalibrateEmulateSample.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/CalibrateEmulateSample.jl/blob/main/docs/src/GaussianProcessEmulator.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Gaussian-Process-Emulator"><a class="docs-heading-anchor" href="#Gaussian-Process-Emulator">Gaussian Process Emulator</a><a id="Gaussian-Process-Emulator-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-Process-Emulator" title="Permalink"></a></h1><p>One type of <code>MachineLearningTool</code> we provide for emulation is a Gaussian process. Gaussian processes are a generalization of the Gaussian probability distribution, extended to functions rather than random variables. They can be used for statistical emulation, as they provide both mean and covariances. To build a Gaussian process, we first define a prior over all possible functions, by choosing the covariance function or kernel. The kernel describes how similar two outputs <code>(y_i, y_j)</code> are, given the similarities between their input values <code>(x_i, x_j)</code>. Kernels encode the functional form of these relationships and are defined by hyperparameters, which are usually initially unknown to the user. To learn the posterior Gaussian process, we condition on data using Bayes theorem and optimize the hyperparameters of the kernel.  Then, we can make predictions to predict a mean function and covariance for new data points.</p><p>A useful resource to learn about Gaussian processes is <a href="http://gaussianprocess.org/gpml/">Rasmussen and Williams (2006)</a>.</p><h1 id="User-Interface"><a class="docs-heading-anchor" href="#User-Interface">User Interface</a><a id="User-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#User-Interface" title="Permalink"></a></h1><p><code>CalibrateEmulateSample.jl</code> allows the Gaussian process emulator to be built using either <a href="https://stor-i.github.io/GaussianProcesses.jl/latest/"><code>GaussianProcesses.jl</code></a>  or <a href="https://scikitlearnjl.readthedocs.io/en/latest/models/#scikitlearn-models"><code>ScikitLearn.jl</code></a>. Different packages may be optimized for different settings, we recommend users give both a try, and checkout the individual package documentation to make a choice for their problem setting. </p><p>To use <code>GaussianProcesses.jl</code>, define the package type as</p><pre><code class="language-julia hljs">gppackage = Emulators.GPJL()</code></pre><p>To use <code>ScikitLearn.jl</code>, define the package type as</p><pre><code class="language-julia hljs">gppackage = Emulators.SKLJL()</code></pre><p>Initialize a basic Gaussian Process with</p><pre><code class="language-julia hljs">gauss_proc = GaussianProcess(gppackage)</code></pre><p>This initializes the prior Gaussian process.  We train the Gaussian process by feeding the <code>gauss_proc</code> alongside the data into the <code>Emulator</code> struct and optimizing the hyperparameters, described <a href="https://clima.github.io/CalibrateEmulateSample.jl/dev/emulate/#Typical-construction-from-Lorenz_example.jl">here</a>.</p><h1 id="Prediction-Type"><a class="docs-heading-anchor" href="#Prediction-Type">Prediction Type</a><a id="Prediction-Type-1"></a><a class="docs-heading-anchor-permalink" href="#Prediction-Type" title="Permalink"></a></h1><p>You can specify the type of prediction when initializing the Gaussian Process emulator. The default type of prediction is to predict data, <code>YType()</code>.  You can create a latent function type prediction with</p><pre><code class="language-julia hljs">gauss_proc = GaussianProcess(
    gppackage,
    prediction_type = FType())
</code></pre><h1 id="Kernels"><a class="docs-heading-anchor" href="#Kernels">Kernels</a><a id="Kernels-1"></a><a class="docs-heading-anchor-permalink" href="#Kernels" title="Permalink"></a></h1><p>The Gaussian process above assumes the default kernel: the Squared Exponential kernel, also called  the <a href="https://en.wikipedia.org/wiki/Radial_basis_function_kernel">Radial Basis Function (RBF)</a>.  A different type of kernel can be specified when the Gaussian process is initialized.  Read more about <a href="https://www.cs.toronto.edu/~duvenaud/cookbook/">kernel options here</a>.</p><h2 id="GPJL"><a class="docs-heading-anchor" href="#GPJL">GPJL</a><a id="GPJL-1"></a><a class="docs-heading-anchor-permalink" href="#GPJL" title="Permalink"></a></h2><p>For the <code>GaussianProcess.jl</code> package, there are <a href="https://stor-i.github.io/GaussianProcesses.jl/latest/kernels">a range of kernels to choose from</a>.  For example, </p><pre><code class="language-julia hljs">using GaussianProcesses
my_kernel = GaussianProcesses.Mat32Iso(0., 0.)      # Create a Matern 3/2 kernel with lengthscale=0 and sd=0
gauss_proc = GaussianProcess(
    gppackage;
    kernel = my_kernel )</code></pre><p>You do not need to provide useful hyperparameter values when you define the kernel, as these are learned in  <code>optimize_hyperparameters!(emulator)</code>.</p><p>You can also combine kernels together through linear operations, for example,</p><pre><code class="language-julia hljs">using GaussianProcesses
kernel_1 = GaussianProcesses.Mat32Iso(0., 0.)      # Create a Matern 3/2 kernel with lengthscale=0 and sd=0
kernel_2 = GaussianProcesses.Lin(0.)               # Create a linear kernel with lengthscale=0
my_kernel = kernel_1 + kernel_2                    # Create a new additive kernel
gauss_proc = GaussianProcess(
    gppackage;
    kernel = my_kernel )</code></pre><h2 id="SKLJL"><a class="docs-heading-anchor" href="#SKLJL">SKLJL</a><a id="SKLJL-1"></a><a class="docs-heading-anchor-permalink" href="#SKLJL" title="Permalink"></a></h2><p>Alternatively if you are using the <code>ScikitLearn.jl</code> package, you can <a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.gaussian_process">find the list of kernels here</a>.  These need this preamble:</p><pre><code class="language-julia hljs">using PyCall
using ScikitLearn
const pykernels = PyNULL()
function __init__()
    copy!(pykernels, pyimport(&quot;sklearn.gaussian_process.kernels&quot;))
end</code></pre><p>Then they are accessible, for example, as</p><pre><code class="language-julia hljs">my_kernel = pykernels.RBF(length_scale = 1)
gauss_proc = GaussianProcess(
    gppackage;
    kernel = my_kernel )</code></pre><p>You can also combine multiple ScikitLearn kernels via linear operations in the same way as above.</p><h1 id="Learning-additional-white-noise"><a class="docs-heading-anchor" href="#Learning-additional-white-noise">Learning additional white noise</a><a id="Learning-additional-white-noise-1"></a><a class="docs-heading-anchor-permalink" href="#Learning-additional-white-noise" title="Permalink"></a></h1><p>Often it is useful to learn the discrepancy between the Gaussian process prediction and the data, by learning additional white noise. Though one often knows, and provides, the discrepancy between the true model and data with an observational noise covariance; the additional white kernel can help account for approximation error from the selected Gaussian process kernel and the true model. This is added with the Boolean keyword <code>noise_learn</code> when initializing the Gaussian process. The default is true. </p><pre><code class="language-julia hljs">gauss_proc = GaussianProcess(
    gppackage;
    noise_learn = true )</code></pre><p>When <code>noise_learn</code> is true, an additional white noise kernel is added to the kernel. This white noise is present across all parameter values, including the training data.  The scale parameters of the white noise kernel are learned in <code>optimize_hyperparameters!(emulator)</code>. </p><p>You may not need to learn the noise if you already have a good estimate of the noise from your training data, and if the Gaussian process kernel is well specified.  When <code>noise_learn</code> is false, a small additional regularization is added for stability. The default value is <code>1e-3</code> but this can be chosen through the optional argument <code>alg_reg_noise</code>:</p><pre><code class="language-julia hljs">gauss_proc = GaussianProcess(
    gppackage;
    noise_learn = false,
    alg_reg_noise = 1e-3 )</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../emulate/">« Emulator</a><a class="docs-footer-nextpage" href="../random_feature_emulator/">Random Features »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 5 April 2024 21:21">Friday 5 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
